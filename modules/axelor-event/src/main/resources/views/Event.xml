<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_5.0.xsd">

  <grid model="com.axelor.event.db.Event" title="Event" name="event-grid">
    <field name="reference"></field>
    <field name="startDate"></field>
    <field name="endDate"></field>
    <field name="registrationOpen"></field>
    <field name="registrationClose"></field>
    <field name="capacity"></field>
    <field name="eventFees"></field>
    <field name="totalEntry"></field>
    <field name="amountCollected"></field>
    <field name="totalDiscount"></field>
  </grid>

  <form model="com.axelor.event.db.Event" title="Event" name="event-form"
    onSave="action-method-validate-registration">
    <panel title="Event OverView">
      <field name="reference"></field>
      <field name="startDate" onChange="action-validate-date"></field>
      <field name="endDate" onChange="action-validate-date"></field>
      <field name="venue" colSpan="10"></field>
      <field name="registrationOpen" onChange="action-validate-date"></field>
      <field name="registrationClose" onChange="action-validate-date"></field>
      <field name="capacity"></field>
      <field name="eventFees"></field>
      <field name="description" colSpan="4"></field>
      <field name="discounts"></field>
      <field name="eventRegistrations" colSpan="10" onChange="action-attrs-for-totalEntry"></field>
      <field name="totalEntry"></field>
      <field name="amountCollected"></field>
      <field name="totalDiscount"></field>
    </panel>
  </form>

  <action-method name="action-method-validate-fileds">
    <call class="com.axelor.event.web.EventController" method="validateRegistration" />
  </action-method>

  <action-attrs name="action-attrs-for-totalEntry">
    <attribute name="value" for="totalEntry" expr="eval :eventRegistrations.size()" />
  </action-attrs>

  <action-validate name="action-validate-date">
    <error message="start date should not be ahead of End Date"
      if="startDate!= null &amp;&amp; endDate!=null &amp;&amp;  startDate &lt; endDate" />
    <error message="Registration Open date should not be ahead of Registration Close Date"
      if="registrationOpen!= null &amp;&amp; registrationClose!=null &amp;&amp;  registrationOpen &lt; registrationClose" />
    <error message="Registration close date must be before event start date" 
    if="registrationClose!=null &amp;&amp; startDate!= null &amp;&amp; registrationClose &lt; startDate"/>
  </action-validate>

</object-views>
